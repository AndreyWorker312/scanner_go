┌─────────────────────────────────────────────────────────────────┐
│                       API Gateway Layer                         │
│                     ┌─────────────┐                             │
│                     │ WS Handler  │                             │
│                     └─────────────┘                             │
└─────────────────────────────────────────────────────────────────┘
│
▼
┌─────────────────────────────────────────────────────────────────┐
│                     Application Layer                           │
│  ┌─────────────────────┐    ┌─────────────────────────────────┐ │
│  │  Scanner Service    │◄───│        Use Cases                │ │
│  │   (Coordinator)     │    │  - StartScanUseCase             │ │
│  └─────────────────────┘    │  - GetScanStatusUseCase         │ │
│                             │  - SubscribeToScanUseCase       │ │
│                             │  - ListScansUseCase             │ │
│                             └─────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
│
▼
┌─────────────────────────────────────────────────────────────────┐
│                       Domain Layer                              │
│  ┌─────────────────────┐    ┌─────────────────────────────────┐ │
│  │    Scan Repository  │    │      Scanner Interfaces         │ │
│  │   (Port)            │    │  - ARPScanner                   │ │
│  └─────────────────────┘    │  - ICMPScanner                  │ │
│                             │  - NmapScanner                  │ │
│                             └─────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
│
▼
┌──────────────────────────────────────────────────────────────────┐
│                   Infrastructure Layer                           │
│  ┌─────────────────────┐    ┌─────────────────────────────────┐  │
│  │   MongoDB Adapter   │    │      Scanner Implementations    │  │
│  │   (Repository)      │    │  - ARPScannerService            │  │
│  └─────────────────────┘    │  - ICMPScannerService           │  │
│                             │  - NmapScannerService           │  │
│                             └─────────────────────────────────┘  │
│  ┌─────────────────────┐                                         │
│  │   RabbitMQ Adapter  │                                         │
│  │   (Message Broker)  │                                         │
│  └─────────────────────┘                                         │
└──────────────────────────────────────────────────────────────────┘